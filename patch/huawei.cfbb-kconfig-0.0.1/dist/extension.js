(()=>{var e={367:e=>{const{hasOwnProperty:t}=Object.prototype,o=(e,t={})=>{"string"==typeof t&&(t={section:t}),t.align=!0===t.align,t.newline=!0===t.newline,t.sort=!0===t.sort,t.whitespace=!0===t.whitespace||!0===t.align,t.platform=t.platform||"undefined"!=typeof process&&process.platform,t.bracketedArray=!1!==t.bracketedArray;const i="win32"===t.platform?"\r\n":"\n",r=t.whitespace?" = ":"=",s=[],c=t.sort?Object.keys(e).sort():Object.keys(e);let l=0;t.align&&(l=a(c.filter((t=>null===e[t]||Array.isArray(e[t])||"object"!=typeof e[t])).map((t=>Array.isArray(e[t])?`${t}[]`:t)).concat([""]).reduce(((e,t)=>a(e).length>=a(t).length?e:t))).length);let d="";const h=t.bracketedArray?"[]":"";for(const t of c){const o=e[t];if(o&&Array.isArray(o))for(const e of o)d+=a(`${t}${h}`).padEnd(l," ")+r+a(e)+i;else o&&"object"==typeof o?s.push(t):d+=a(t).padEnd(l," ")+r+a(o)+i}t.section&&d.length&&(d="["+a(t.section)+"]"+(t.newline?i+i:i)+d);for(const r of s){const a=n(r,".").join("\\."),s=(t.section?t.section+".":"")+a,c=o(e[r],{...t,section:s});d.length&&c.length&&(d+=i),d+=c}return d};function n(e,t){var o=0,n=0,i=0,r=[];do{if(-1!==(i=e.indexOf(t,o))){if(o=i+t.length,i>0&&"\\"===e[i-1])continue;r.push(e.slice(n,i)),n=i+t.length}}while(-1!==i);return r.push(e.slice(n)),r}const i=(e,o={})=>{o.bracketedArray=!1!==o.bracketedArray;const i=Object.create(null);let r=i,a=null;const c=/^\[([^\]]*)\]\s*$|^([^=]+)(=(.*))?$/i,l=e.split(/[\r\n]+/g),d={};for(const e of l){if(!e||e.match(/^\s*[;#]/)||e.match(/^\s*$/))continue;const n=e.match(c);if(!n)continue;if(void 0!==n[1]){if(a=s(n[1]),"__proto__"===a){r=Object.create(null);continue}r=i[a]=i[a]||Object.create(null);continue}const l=s(n[2]);let h;o.bracketedArray?h=l.length>2&&"[]"===l.slice(-2):(d[l]=(d?.[l]||0)+1,h=d[l]>1);const f=h?l.slice(0,-2):l;if("__proto__"===f)continue;const u=!n[3]||s(n[4]),p="true"===u||"false"===u||"null"===u?JSON.parse(u):u;h&&(t.call(r,f)?Array.isArray(r[f])||(r[f]=[r[f]]):r[f]=[]),Array.isArray(r[f])?r[f].push(p):r[f]=p}const h=[];for(const e of Object.keys(i)){if(!t.call(i,e)||"object"!=typeof i[e]||Array.isArray(i[e]))continue;const o=n(e,".");r=i;const a=o.pop(),s=a.replace(/\\\./g,".");for(const e of o)"__proto__"!==e&&(t.call(r,e)&&"object"==typeof r[e]||(r[e]=Object.create(null)),r=r[e]);r===i&&s===a||(r[s]=i[e],h.push(e))}for(const e of h)delete i[e];return i},r=e=>e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"),a=e=>"string"!=typeof e||e.match(/[=\r\n]/)||e.match(/^\[/)||e.length>1&&r(e)||e!==e.trim()?JSON.stringify(e):e.split(";").join("\\;").split("#").join("\\#"),s=e=>{if(e=(e||"").trim(),!r(e)){let t=!1,o="";for(let n=0,i=e.length;n<i;n++){const i=e.charAt(n);if(t)-1!=="\\;#".indexOf(i)?o+=i:o+="\\"+i,t=!1;else{if(-1!==";#".indexOf(i))break;"\\"===i?t=!0:o+=i}}return t&&(o+="\\"),o.trim()}"'"===e.charAt(0)&&(e=e.slice(1,-1));try{e=JSON.parse(e)}catch{}return e};e.exports={parse:i,decode:i,stringify:o,encode:o,safe:a,unsafe:s}},170:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.showModal=t.getWorkFolderPath=t.IniUtil=t.excuteCommand=t.configCheck=void 0;const s=r(o(896)),c=r(o(398)),l=r(o(367)),d=o(979),h=o(317),f=a(o(928)),u=(0,o(23).promisify)(h.exec);let p={compilerBinPath:"",menuConfigFilePath:"",board:"",menuConfigCore:"",menuConfigBuildTarget:"",menuConfigTargetPath:""};t.configCheck=function(e,t){return void 0===e.compilerBinPath||""===e.compilerBinPath?(c.window.showErrorMessage((0,d.res)("CompilerBinPathNotSet")),!1):s.existsSync(e.compilerBinPath)?""===e.menuConfigFilePath||void 0===e.menuConfigFilePath?(c.window.showErrorMessage((0,d.res)("ConfigFilePathNotSet")),!1):s.existsSync(f.default.join(t,e.menuConfigFilePath))?""===e.board||void 0===e.board?(c.window.showErrorMessage((0,d.res)("BoardError")),!1):""===e.menuConfigCore||void 0===e.menuConfigCore?(c.window.showErrorMessage((0,d.res)("ConfigCoreError")),!1):""===e.menuConfigBuildTarget||void 0===e.menuConfigBuildTarget?(c.window.showErrorMessage((0,d.res)("ConfigBuildTargetError")),!1):""===e.menuConfigTargetPath||void 0===e.menuConfigTargetPath?(c.window.showErrorMessage((0,d.res)("ConfigTargetPathNotSet")),!1):!!s.existsSync(f.default.join(t,e.menuConfigTargetPath))||(c.window.showErrorMessage((0,d.res)("ConfigTargetPathNotExist")),!1):(c.window.showErrorMessage((0,d.res)("ConfigFilePathNotExist")),!1):(c.window.showErrorMessage((0,d.res)("CompilerBinPathNotExist")),!1)},t.excuteCommand=(e,o)=>new Promise(((e,n)=>{try{let n="Start installing...";setInterval((()=>o.report({message:n})),500);const i=f.default.resolve(__dirname,"..","resources","scripts","pythonCheck.bat");(0,h.spawn)(i).on("exit",(async o=>{if(1===o||2===o||3===o||4===o){if(await(0,t.showModal)("tips",(0,d.res)("noPython"),(0,d.res)("ok"))===(0,d.res)("ok")){c.window.showInformationMessage((0,d.res)("downloadingPathon"));const e=f.default.resolve(__dirname,"..","resources","scripts","pythonInstall.bat");(0,h.spawn)(e).on("exit",(async e=>0!==e?(c.window.showInformationMessage((0,d.res)("downloadingPathonFailed")),void(0,t.showModal)("tips",(0,d.res)("pythonInstallFail"))):void c.window.showInformationMessage((0,d.res)("downloadingPathonSuccessed"))))}}else{if(5===o)return c.window.showInformationMessage((0,d.res)("addPythonPath")),void(await(0,t.showModal)("tips",(0,d.res)("noPythonPath"),(0,d.res)("ok"))===(0,d.res)("ok")&&(0,h.exec)("rundll32 sysdm.cpl,EditEnvironmentVariables"));{let o="",n="";const i=async(e,t,i)=>{try{await u(e)}catch(e){try{await u(t)}catch(e){switch(i){case"kconfiglib":o=i;break;case"windows_curses":n=i}}}};if(await Promise.all([i("pip show kconfiglib","pip install kconfiglib==14.1.0","kconfiglib"),i("pip show windows_curses","pip install windows_curses==2.33","windows_curses")]),""!==o||""!==n)return""!==o&&c.window.showInformationMessage((0,d.res)("noKconfiglib")),""!==n&&c.window.showInformationMessage((0,d.res)("noWindows_curses")),void(0,t.showModal)("tips",(0,d.res)("noPip",[o,n]));e()}}}))}catch(e){n(new Error(e))}})),t.IniUtil=class{static getProjectFile(e){let t="";return s.existsSync(e)?(s.readdirSync(e).forEach((o=>{const n=f.default.join(e,o);n.endsWith(".hiproj")&&(t=n)})),t):t}static readIniFile(e){if(s.existsSync(e)){const t=s.readFileSync(e,"utf-8").toString();return l.parse(t)}}static getIniConfig(e){if(s.existsSync(e)){const t=this.readIniFile(e);void 0!==t&&(p.compilerBinPath=f.default.join(c.env.appRoot,"..","..","tools","cfbb"),p.menuConfigFilePath=t.kConfig.menu_config_file_path,p.board=t.information.board,p.menuConfigCore=t.kConfig.menu_config_core,p.menuConfigBuildTarget=t.kConfig.menu_config_build_target,p.menuConfigTargetPath=t.kConfig.menu_config_target_path)}else c.window.showErrorMessage((0,d.res)("NoConfigError"));return p}},t.getWorkFolderPath=function(){const e=c.workspace.workspaceFolders;return e&&e.length?e[0].uri.fsPath:""},t.showModal=async(e,t,...o)=>"tips"===e?await c.window.showInformationMessage((0,d.res)(e),{modal:!0,detail:t},...o):"warning"===e?await c.window.showWarningMessage((0,d.res)(e),{modal:!0,detail:t},...o):await c.window.showErrorMessage((0,d.res)(e),{modal:!0,detail:t},...o)},265:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.activate=t.extension=void 0;const s=r(o(398)),c=o(170),l=a(o(928)),d=o(979),h=r(o(896)),f=r(o(367));class u{constructor(){this.workSpacePath=s.workspace.workspaceFolders?s.workspace.workspaceFolders[0].uri.fsPath:"",this.iniPath=c.IniUtil.getProjectFile((0,c.getWorkFolderPath)())}activate(e){const t=l.default.join(e.extensionPath,"configHandler","show_config.py"),o=this.iniPath;e.subscriptions.push(s.commands.registerCommand("HiSparkStudio.showGUIConfig",(async()=>{const e=c.IniUtil.getIniConfig(o);(0,c.configCheck)(e,this.workSpacePath)&&s.window.withProgress({location:s.ProgressLocation.Notification,title:"Tool package environment installing",cancellable:!1},(async o=>(0,c.excuteCommand)(e,o).then((()=>{const o=`${e.menuConfigFilePath} ${e.board} ${e.menuConfigCore} ${e.menuConfigBuildTarget} ${e.menuConfigTargetPath}`,n=new s.Task({type:"shell"},s.TaskScope.Workspace,"GUI Config","My Extension",new s.ShellExecution(`python  \\"${t}\\" \\"${o}\\" \\"guiconfig\\"`));s.tasks.executeTask(n)}))))})));const n=s.Uri.file(l.default.resolve(__dirname,"../resources","kconfig.svg")),i=s.window.createToolBarItem("HiSparkStudio.showGUIConfig",(0,d.res)("Kconfig"),n,(0,d.res)("Description"),"6_other",4);if(i.command="HiSparkStudio.showGUIConfig",e.subscriptions.push(i),h.existsSync(this.iniPath)){const e=f.parse(h.readFileSync(this.iniPath).toString());e.kConfig?.menu_config_file_path?i.enable():i.disable()}else i.disable();s.window.registerMenu("projectSubmenu",{command:{id:"HiSparkStudio.showGUIConfig",title:(0,d.res)("Kconfig"),precondition:"workspaceFolderCount"},group:"3_operation",order:14}),s.window.registerMenu("MenubarMainMenu",{submenu:"projectSubmenu",title:(0,d.res)("ProjectSubmenu"),order:6})}}t.default=u,t.extension=new u,t.activate=e=>{t.extension.activate(e)}},979:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.res=void 0;const a=r(o(398));t.res=function(e,t){const n=o(281),i=o(8);let r;if(r=a.env.language.includes("zh")?n[e]||e:i[e]||e,!t||0===t.length)return r;for(let e=0;e<t.length;e++)r.indexOf(`{${e}}`)>=0&&(r=r.replace(`{${e}}`,t[e]));return r}},398:e=>{"use strict";e.exports=require("vscode")},317:e=>{"use strict";e.exports=require("child_process")},896:e=>{"use strict";e.exports=require("fs")},928:e=>{"use strict";e.exports=require("path")},23:e=>{"use strict";e.exports=require("util")},8:e=>{"use strict";e.exports=JSON.parse('{"AllConfigSaveSuccess":"All config has been saved to {0}","DefaultConfigSaveSuccess":"Default config has been saved to {0}","NoConfigError":"Global config file deveco.ini dosen\'t exist","CompilerBinPathNotSet":"compiler_bin_path not set","CompilerBinPathNotExist":"compiler_bin_path not exist","ConfigFilePathNotSet":"menu_config_file_path not set","ConfigFilePathNotExist":"menu_config_file_path not exist","BoardError":"board not set","ConfigCoreError":"menu_config_core not set","ConfigBuildTargetError":"menu_config_build_target not set","ConfigTargetPathNotSet":"menu_config_target_path not set","ConfigTargetPathNotExist":"menu_config_target_path not exist","Description":"Configure the functional modules participating in compilation by modifying the compilation macro.","ProjectSubmenu":"&&Project","noPython":"Python is not installed on the local PC or the Python version is not 3.11.4. Click OK to download and install Python 3.11.4.","pythonInstallFail":"Failed to download and install python3.11.4. Manually download and install python3.11.4. Download link: https://repo.huaweicloud.com/python/3.11.4/python-3.11.4-amd64.exe","downloadingPathon":"Downloading and installing python3.11.4... Please wait.","downloadingPathonFailed":"Failed to install python3.11.4. Manually install it. After the installation, close all HiSpark Studio windows, open them again, and perform the system configuration function.","downloadingPathonSuccessed":"Python 3.11.4 is installed successfully, but the system configuration fails. Close all HiSpark Studio windows, open them again, and configure the system again.","noPythonPath":"Python3.11 does not take effect. Python311 has been added to the header of the system environment variable. To make the environment variable take effect, click OK. The environment variable interface is displayed. Perform operations according to the prompt information of the terminal.","noPip":"Failed to download {0} {1}. Perform operations by referring to the message displayed in the notification bar in the lower right corner or chapter 12 Common Errors in the user guide.If the operation still fails, close all HiSpark Studio windows, open them again, and configure the system again.","noKconfiglib":"Failed to download kconfiglib. Download the .whl file to any directory, open the cmd window, and run pip install kconfiglib-14.1.0-py2.py3-none-any.whl.","noWindows_curses":"Failed to download windows_curses. Download the .whl file to any directory, open the cmd window, and run pip install windows_curses-2.3.3-cp311-cp311-win_amd64.whl.","addPythonPath":"In the Environment Variables dialog box, check the PATH parameter in the System Variables area. Check whether python311 and its Scripts directory are added to the head of the system environment variables. If yes, Close all HiSpark Studio windows and then open them again. If not, manually add the Python installation paths (such as C:\\\\Users\\\\UserName\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python311Python\\\\Python311 and python3.11.4) to the environment variable header.","tips":"tips","Kconfig":"kconfig"}')},281:e=>{"use strict";e.exports=JSON.parse('{"AllConfigSaveSuccess":"全部配置已被保存至{0}","DefaultConfigSaveSuccess":"默认配置已被保存至{0}","NoConfigError":"全局配置文件deveco.ini不存在","CompilerBinPathNotSet":"compiler_bin_path 未配置","CompilerBinPathNotExist":"compiler_bin_path 不存在","ConfigFilePathNotSet":"menu_config_file_path 未配置","ConfigFilePathNotExist":"menu_config_file_path 不存在","BoardError":"单板型号未知","ConfigCoreError":"menu_config_core 未配置","ConfigBuildTargetError":"menu_config_build_target 未配置","ConfigTargetPathNotSet":"menu_config_target_path 未配置","ConfigTargetPathNotExist":"menu_config_target_path 不存在","Description":"通过修改编译宏，配置参与编译的功能模块","ProjectSubmenu":"工程(&&P)","noPython":"本地没有安装python或者python版本不为3.11.4，点击确定一键下载安装python3.11.4","pythonInstallFail":"python3.11.4下载安装失败，请手动下载安装python3.11.4。下载链接：https://repo.huaweicloud.com/python/3.11.4/python-3.11.4-amd64.exe","downloadingPathon":"正在下载并安装python3.11.4，请稍后","downloadingPathonFailed":"python3.11.4安装失败，请手动安装，安装后请关闭所有HiSpark Studio窗口再打开，再执行系统配置功能","downloadingPathonSuccessed":"python3.11.4安装成功，本次系统配置失败，请关闭所有HiSpark Studio窗口再打开，重新执行系统配置","noPythonPath":"Python3.11未生效，现已经将Python311添加至系统环境变量头部，为使环境变量成功生效，点击“确定”，会弹出环境变量界面，请参考右下角通知栏的提示信息进行操作。","noPip":"{0} {1}组件下载失败，请参考右下角通知栏的提示信息或用户指南中的第12章常见错误进行操作，操作完成后若仍失败请关闭所有HiSpark Studio窗口再打开，重新执行系统配置","noKconfiglib":"kconfiglib下载失败，请下载对应的whl文件至任意目录，在该目录下打开命令提示符（cmd）执行pip install kconfiglib-14.1.0-py2.py3-none-any.whl即可，下载链接：https://files.pythonhosted.org/packages/8a/f1/d98a89231e779b079b977590efcc31249d959c8f1d4b5858cad69695ff9c/kconfiglib-14.1.0-py2.py3-none-any.whl","noWindows_curses":"windows_curses下载失败，请下载对应的whl文件至任意目录，在该目录下打开命令提示符（cmd）执行pip install windows_curses-2.3.3-cp311-cp311-win_amd64.whl即可，下载链接：https://files.pythonhosted.org/packages/18/1b/e06eb41dad1c74f0d3124218084f258f73a5e76c67112da0ba174162670f/windows_curses-2.3.3-cp311-cp311-win_amd64.whl","addPythonPath":"请检查弹出的环境变量窗口中的系统环境变量中的\'PATH\'参数，是否将\'python311\'及其Scripts目录添加至系统环境变量的头部，如果添加成功，为保证添加的环境变量成功生效，请关闭所有HiSpark Studio窗口并打开继续正常使用；如果没有添加成功，请手动将python3.11.4的python安装路径如\'C:\\\\Users\\\\UserName\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python311Python\\\\Python311\'和\'C:\\\\Users\\\\UserName\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python311\\\\Scripts\'添加至系统环境变量头部，添加成功后，为保证添加的环境变量成功生效，请关闭所有HiSpark Studio窗口并打开继续正常使用。","tips":"提示","Kconfig":"系统配置"}')}},t={},o=function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}(265);module.exports=o})();